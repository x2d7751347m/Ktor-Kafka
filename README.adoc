= ktor websocket sample

== How to tune

. change parameters in `src/main/resources`
. set aws environmental variables and github actions secrets in `.github/workflows/aws.yml`

== Architecture

=== Cloud Architecture of AWS ECS with ALB
image::Cloud Architecture of AWS ECS with ALB.jpg[]

=== Producers and consumers writing and reading events from Kafka topics (/messages/{group})
image::kafka-producers-consumers-topics.jpg[]


/chat consists of connections only within one server.

=== Ci/cd pipeline
image::aws_architecture.jpg[]

== Example

utube video

. run `docker-compose up -d`
. run `RunningAverage`
. produce some data with `ConsoleProducer`

[source,bash]
.Consume from result topic
----
docker exec -it broker /usr/bin/kafka-console-consumer --topic rating-averages --bootstrap-server broker:9092 --property "print.key=true"\
 --property "key.deserializer=org.apache.kafka.common.serialization.LongDeserializer" --property "value.deserializer=org.apache.kafka.common.serialization.DoubleDeserializer" --from-beginning
----

